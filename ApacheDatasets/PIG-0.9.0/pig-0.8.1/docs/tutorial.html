<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="Apache Forrest" name="Generator">
<meta name="Forrest-version" content="0.8">
<meta name="Forrest-skin-name" content="pelt">
<title>Pig Tutorial</title>
<link type="text/css" href="skin/basic.css" rel="stylesheet">
<link media="screen" type="text/css" href="skin/screen.css" rel="stylesheet">
<link media="print" type="text/css" href="skin/print.css" rel="stylesheet">
<link type="text/css" href="skin/profile.css" rel="stylesheet">
<script src="skin/getBlank.js" language="javascript" type="text/javascript"></script><script src="skin/getMenu.js" language="javascript" type="text/javascript"></script><script src="skin/fontsize.js" language="javascript" type="text/javascript"></script>
<link rel="shortcut icon" href="">
</head>
<body onload="init()">
<script type="text/javascript">ndeSetTextSize();</script>
<div id="top">
<!--+
    |breadtrail
    +-->
<div class="breadtrail">
<a href="http://www.apache.org/">Apache</a> &gt; <a href="http://hadoop.apache.org/">Hadoop</a> &gt; <a href="http://hadoop.apache.org/pig/">Pig</a><script src="skin/breadcrumbs.js" language="JavaScript" type="text/javascript"></script>
</div>
<!--+
    |header
    +-->
<div class="header">
<!--+
    |start group logo
    +-->
<div class="grouplogo">
<a href="http://hadoop.apache.org/"><img class="logoImage" alt="Hadoop" src="images/hadoop-logo.jpg" title="Apache Hadoop"></a>
</div>
<!--+
    |end group logo
    +-->
<!--+
    |start Project Logo
    +-->
<div class="projectlogo">
<a href="http://hadoop.apache.org/pig/"><img class="logoImage" alt="Pig" src="images/pig-logo.gif" title="A platform for analyzing large datasets."></a>
</div>
<!--+
    |end Project Logo
    +-->
<!--+
    |start Search
    +-->
<div class="searchbox">
<form action="http://www.google.com/search" method="get" class="roundtopsmall">
<input value="" name="sitesearch" type="hidden"><input onFocus="getBlank (this, 'Search the site with google');" size="25" name="q" id="query" type="text" value="Search the site with google">&nbsp; 
                    <input name="Search" value="Search" type="submit">
</form>
</div>
<!--+
    |end search
    +-->
<!--+
    |start Tabs
    +-->
<ul id="tabs">
<li>
<a class="unselected" href="http://hadoop.apache.org/pig/">Project</a>
</li>
<li>
<a class="unselected" href="http://wiki.apache.org/pig/">Wiki</a>
</li>
<li class="current">
<a class="selected" href="index.html">Pig 0.8.0 Documentation</a>
</li>
</ul>
<!--+
    |end Tabs
    +-->
</div>
</div>
<div id="main">
<div id="publishedStrip">
<!--+
    |start Subtabs
    +-->
<div id="level2tabs"></div>
<!--+
    |end Endtabs
    +-->
<script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
</div>
<!--+
    |breadtrail
    +-->
<div class="breadtrail">

             &nbsp;
           </div>
<!--+
    |start Menu, mainarea
    +-->
<!--+
    |start Menu
    +-->
<div id="menu">
<div onclick="SwitchMenu('menu_selected_1.1', 'skin/')" id="menu_selected_1.1Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Pig</div>
<div id="menu_selected_1.1" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="index.html">Overview</a>
</div>
<div class="menuitem">
<a href="setup.html">Setup</a>
</div>
<div class="menupage">
<div class="menupagetitle">Tutorial</div>
</div>
<div class="menuitem">
<a href="piglatin_ref1.html">Pig Latin 1</a>
</div>
<div class="menuitem">
<a href="piglatin_ref2.html">Pig Latin 2</a>
</div>
<div class="menuitem">
<a href="cookbook.html">Cookbook</a>
</div>
<div class="menuitem">
<a href="udf.html">UDFs</a>
</div>
<div class="menuitem">
<a href="pigunit.html">PigUnit</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.2', 'skin/')" id="menu_1.2Title" class="menutitle">Zebra</div>
<div id="menu_1.2" class="menuitemgroup">
<div class="menuitem">
<a href="zebra_overview.html">Zebra Overview </a>
</div>
<div class="menuitem">
<a href="zebra_users.html">Zebra Users </a>
</div>
<div class="menuitem">
<a href="zebra_reference.html">Zebra Reference </a>
</div>
<div class="menuitem">
<a href="zebra_mapreduce.html">Zebra MapReduce </a>
</div>
<div class="menuitem">
<a href="zebra_pig.html">Zebra Pig </a>
</div>
<div class="menuitem">
<a href="zebra_stream.html">Zebra Streaming </a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.3', 'skin/')" id="menu_1.3Title" class="menutitle">Miscellaneous</div>
<div id="menu_1.3" class="menuitemgroup">
<div class="menuitem">
<a href="api/">API Docs</a>
</div>
<div class="menuitem">
<a href="jdiff/changes.html">API Changes</a>
</div>
<div class="menuitem">
<a href="http://wiki.apache.org/pig/">Wiki</a>
</div>
<div class="menuitem">
<a href="http://wiki.apache.org/pig/FAQ">FAQ</a>
</div>
<div class="menuitem">
<a href="http://pig.apache.org/releases.html">Release Notes</a>
</div>
</div>
<div id="credit"></div>
<div id="roundbottom">
<img style="display: none" class="corner" height="15" width="15" alt="" src="skin/images/rc-b-l-15-1body-2menu-3menu.png"></div>
<!--+
  |alternative credits
  +-->
<div id="credit2"></div>
</div>
<!--+
    |end Menu
    +-->
<!--+
    |start content
    +-->
<div id="content">
<div title="Portable Document Format" class="pdflink">
<a class="dida" href="tutorial.pdf"><img alt="PDF -icon" src="skin/images/pdfdoc.gif" class="skin"><br>
        PDF</a>
</div>
<h1>Pig Tutorial</h1>
<div id="minitoc-area">
<ul class="minitoc">
<li>
<a href="#Overview">Overview</a>
</li>
<li>
<a href="#Check+Your+Setup">Check Your Setup</a>
</li>
<li>
<a href="#Running+the+Pig+Scripts+in+Local+Mode"> Running the Pig Scripts in Local Mode</a>
</li>
<li>
<a href="#Running+the+Pig+Scripts+in+Mapreduce+Mode"> Running the Pig Scripts in Mapreduce Mode</a>
</li>
<li>
<a href="#Pig+Tutorial+Files"> Pig Tutorial Files</a>
</li>
<li>
<a href="#Pig+Script+1%3A+Query+Phrase+Popularity"> Pig Script 1: Query Phrase Popularity</a>
</li>
<li>
<a href="#Pig+Script+2%3A+Temporal+Query+Phrase+Popularity">Pig Script 2: Temporal Query Phrase Popularity</a>
</li>
</ul>
</div>


<a name="N1000D"></a><a name="Overview"></a>
<h2 class="h3">Overview</h2>
<div class="section">
<p>The Pig tutorial shows you how to run two Pig scripts in local mode and mapreduce mode.   </p>
<ul>

<li>
<strong>Local Mode</strong>: To run the scripts in local mode, no Hadoop or HDFS installation is required. All files are installed and run from your local host and file system.</li>

<li>
<strong>Mapreduce Mode</strong>: To run the scripts in mapreduce mode, you need access to a Hadoop cluster and HDFS installation.</li>

</ul>
</div>


<a name="N10024"></a><a name="Check+Your+Setup"></a>
<h2 class="h3">Check Your Setup</h2>
<div class="section">
<p>Check your run-time environment and do the following preliminary tasks:</p>
<ol>

<li>Make sure the JAVA_HOME environment variable is set the root of your Java installation.</li>

<li>Make sure your PATH includes bin/pig (this enables you to run the tutorials using the "pig" command).
<pre class="code">
$ export PATH=/&lt;my-path-to-pig&gt;/pig-0.8.0/bin:$PATH 
</pre>

</li>

<li>Set the PIG_HOME environment variable:
<pre class="code">
$ export PIG_HOME=/&lt;my-path-to-pig&gt;/pig-0.8.0 
</pre>
</li>

<li>Create the pigtutorial.tar.gz file:
<ul>
    
<li>Move to the Pig tutorial directory (.../pig-0.8.0/tutorial).</li>
	
<li>Edit the build.xml file in the tutorial directory. 
<pre class="code">
Change this:   &lt;property name="pigjar" value="../pig.jar" /&gt;
To this:       &lt;property name="pigjar" value="../pig-0.8.0-core.jar" /&gt;
</pre>
	
</li>
	
<li>Run the "ant" command from the tutorial directory. This will create the pigtutorial.tar.gz file.
	</li>

</ul>


</li>

<li>Copy the pigtutorial.tar.gz file from the Pig tutorial directory to your local directory. </li>

<li>Unzip the pigtutorial.tar.gz file.
<pre class="code">
$ tar -xzf pigtutorial.tar.gz
</pre>

</li>

<li>A new directory named pigtmp is created. This directory contains the Pig tutorial files. 
These files work with Hadoop 0.20.2 and include everything you need to run the Pig scripts.</li>

</ol>
</div>



<a name="N10061"></a><a name="Running+the+Pig+Scripts+in+Local+Mode"></a>
<h2 class="h3"> Running the Pig Scripts in Local Mode</h2>
<div class="section">
<p>To run the Pig scripts in local mode, do the following: </p>
<ol>


<li>Move to the pigtmp directory.</li>

<li>Execute the following command using script1-local.pig (or script2-local.pig). 
<pre class="code">
$ pig -x local script1-local.pig
</pre>

<p>The output may contain a few Hadoop warnings which can be ignored:</p>

<pre class="code">
2010-04-08 12:55:33,642 [main] INFO  org.apache.hadoop.metrics.jvm.JvmMetrics 
- Cannot initialize JVM Metrics with processName=JobTracker, sessionId= - already initialized
</pre>

</li>

<li>A directory named script1-local-results.txt (or script2-local-results.txt) is created. This directory contains the results file, part-r-0000.</li>

</ol>
</div>


<a name="N10082"></a><a name="Running+the+Pig+Scripts+in+Mapreduce+Mode"></a>
<h2 class="h3"> Running the Pig Scripts in Mapreduce Mode</h2>
<div class="section">
<p>To run the Pig scripts in mapreduce mode, do the following: </p>
<ol>

<li>Move to the pigtmp directory.</li>

<li>Copy the excite.log.bz2 file from the pigtmp directory to the HDFS directory.
<pre class="code">
$ hadoop fs &ndash;copyFromLocal excite.log.bz2 .
</pre>

</li>


<li>Set the PIG_CLASSPATH environment variable to the location of the cluster configuration directory (the directory that contains the core-site.xml, hdfs-site.xml and mapred-site.xml files):
<pre class="code">
export PIG_CLASSPATH=/mycluster/conf
</pre>
</li>

<li>Set the HADOOP_CONF_DIR environment variable to the location of the cluster configuration directory:
<pre class="code">
export HADOOP_CONF_DIR=/mycluster/conf
</pre>
</li>


<li>Execute the following command (using either script1-hadoop.pig or script2-hadoop.pig):
<pre class="code">
$ pig script1-hadoop.pig
</pre>

</li>


<li>Review the result files, located in the script1-hadoop-results or script2-hadoop-results HDFS directory:
<pre class="code">
$ hadoop fs -ls script1-hadoop-results
$ hadoop fs -cat 'script1-hadoop-results/*' | less
</pre>

</li>

</ol>
</div>


<a name="N100B3"></a><a name="Pig+Tutorial+Files"></a>
<h2 class="h3"> Pig Tutorial Files</h2>
<div class="section">
<p>The contents of the Pig tutorial file (pigtutorial.tar.gz) are described here. </p>
<table class="ForrestTable" cellspacing="1" cellpadding="4">

<tr>

<td colspan="1" rowspan="1">

<p> 
<strong>File</strong> 
</p>

</td>
<td colspan="1" rowspan="1">

<p> 
<strong>Description</strong>
</p>

</td>

</tr>

<tr>

<td colspan="1" rowspan="1">

<p> pig.jar </p>

</td>
<td colspan="1" rowspan="1">

<p> Pig JAR file </p>

</td>

</tr>

<tr>

<td colspan="1" rowspan="1">

<p> tutorial.jar </p>

</td>
<td colspan="1" rowspan="1">

<p> User-defined functions (UDFs) and Java classes </p>

</td>

</tr>

<tr>

<td colspan="1" rowspan="1">

<p> script1-local.pig </p>

</td>
<td colspan="1" rowspan="1">

<p> Pig Script 1, Query Phrase Popularity (local mode) </p>

</td>

</tr>

<tr>

<td colspan="1" rowspan="1">

<p> script1-hadoop.pig </p>

</td>
<td colspan="1" rowspan="1">

<p> Pig Script 1, Query Phrase Popularity (Hadoop cluster) </p>

</td>

</tr>

<tr>

<td colspan="1" rowspan="1">

<p> script2-local.pig </p>

</td>
<td colspan="1" rowspan="1">

<p> Pig Script 2, Temporal Query Phrase Popularity (local mode)</p>

</td>

</tr>

<tr>

<td colspan="1" rowspan="1">

<p> script2-hadoop.pig </p>

</td>
<td colspan="1" rowspan="1">

<p> Pig Script 2, Temporal Query Phrase Popularity (Hadoop cluster) </p>

</td>

</tr>

<tr>

<td colspan="1" rowspan="1">

<p> excite-small.log </p>

</td>
<td colspan="1" rowspan="1">

<p> Log file, Excite search engine (local mode) </p>

</td>

</tr>

<tr>

<td colspan="1" rowspan="1">

<p> excite.log.bz2 </p>

</td>
<td colspan="1" rowspan="1">

<p> Log file, Excite search engine (Hadoop cluster) </p>

</td>

</tr>

</table>
<p>The user-defined functions (UDFs) are described here. </p>
<table class="ForrestTable" cellspacing="1" cellpadding="4">

<tr>

<td colspan="1" rowspan="1">

<p> 
<strong>UDF</strong> 
</p>

</td>
<td colspan="1" rowspan="1">

<p> 
<strong>Description</strong>
</p>

</td>

</tr>

<tr>

<td colspan="1" rowspan="1">

<p> ExtractHour </p>

</td>
<td colspan="1" rowspan="1">

<p> Extracts the hour from the record.</p>

</td>

</tr>

<tr>

<td colspan="1" rowspan="1">

<p> NGramGenerator </p>

</td>
<td colspan="1" rowspan="1">

<p> Composes n-grams from the set of words. </p>

</td>

</tr>

<tr>

<td colspan="1" rowspan="1">

<p> NonURLDetector </p>

</td>
<td colspan="1" rowspan="1">

<p> Removes the record if the query field is empty or a URL. </p>

</td>

</tr>

<tr>

<td colspan="1" rowspan="1">

<p> ScoreGenerator </p>

</td>
<td colspan="1" rowspan="1">

<p> Calculates a "popularity" score for the n-gram.</p>

</td>

</tr>

<tr>

<td colspan="1" rowspan="1">

<p> ToLower </p>

</td>
<td colspan="1" rowspan="1">

<p> Changes the query field to lowercase. </p>

</td>

</tr>

<tr>

<td colspan="1" rowspan="1">

<p> TutorialUtil </p>

</td>
<td colspan="1" rowspan="1">

<p> Divides the query string into a set of words.</p>

</td>

</tr>

</table>
</div>


<a name="N10200"></a><a name="Pig+Script+1%3A+Query+Phrase+Popularity"></a>
<h2 class="h3"> Pig Script 1: Query Phrase Popularity</h2>
<div class="section">
<p>The Query Phrase Popularity script (script1-local.pig or script1-hadoop.pig) processes a search query log file from the Excite search engine and finds search phrases that occur with particular high frequency during certain times of the day. </p>
<p>The script is shown here: </p>
<ul>

<li>
<p> Register the tutorial JAR file so that the included UDFs can be called in the script. </p>

</li>

</ul>
<pre class="code">
REGISTER ./tutorial.jar; 
</pre>
<ul>

<li>
<p> Use the PigStorage function to load the excite log file (excite.log or excite-small.log) into the &ldquo;raw&rdquo; bag as an array of records with the fields <strong>user</strong>, <strong>time</strong>, and <strong>query</strong>.  </p>

</li>

</ul>
<pre class="code">
raw = LOAD 'excite.log' USING PigStorage('\t') AS (user, time, query);
</pre>
<ul>

<li>
<p> Call the NonURLDetector UDF to remove records if the query field is empty or a URL.  </p>

</li>

</ul>
<pre class="code">
clean1 = FILTER raw BY org.apache.pig.tutorial.NonURLDetector(query);
</pre>
<ul>

<li>
<p> Call the ToLower UDF to change the query field to lowercase.  </p>

</li>

</ul>
<pre class="code">
clean2 = FOREACH clean1 GENERATE user, time, org.apache.pig.tutorial.ToLower(query) as query;
</pre>
<ul>

<li>
<p> Because the log file only contains queries for a single day, we are only interested in the hour. The excite query log timestamp format is YYMMDDHHMMSS. Call the ExtractHour UDF to extract the hour (HH) from the time field. </p>

</li>

</ul>
<pre class="code">
houred = FOREACH clean2 GENERATE user, org.apache.pig.tutorial.ExtractHour(time) as hour, query;
</pre>
<ul>

<li>
<p> Call the NGramGenerator UDF to compose the n-grams of the query. </p>

</li>

</ul>
<pre class="code">
ngramed1 = FOREACH houred GENERATE user, hour, flatten(org.apache.pig.tutorial.NGramGenerator(query)) as ngram;
</pre>
<ul>

<li>
<p> Use the DISTINCT operator to get the unique n-grams for all records.  </p>

</li>

</ul>
<pre class="code">
ngramed2 = DISTINCT ngramed1;
</pre>
<ul>

<li>
<p> Use the GROUP operator to group records by n-gram and hour. </p>

</li>

</ul>
<pre class="code">
hour_frequency1 = GROUP ngramed2 BY (ngram, hour);
</pre>
<ul>

<li>
<p> Use the COUNTfunction to get the count (occurrences) of each n-gram.  </p>

</li>

</ul>
<pre class="code">
hour_frequency2 = FOREACH hour_frequency1 GENERATE flatten($0), COUNT($1) as count;
</pre>
<ul>

<li>
<p> Use the GROUP operator to group records by n-gram only. Each group now corresponds to a distinct n-gram and has the count for each hour. </p>

</li>

</ul>
<pre class="code">
uniq_frequency1 = GROUP hour_frequency2 BY group::ngram;
</pre>
<ul>

<li>
<p> For each group, identify the hour in which this n-gram is used with a particularly high frequency. Call the ScoreGenerator UDF to calculate a "popularity" score for the n-gram. </p>

</li>

</ul>
<pre class="code">
uniq_frequency2 = FOREACH uniq_frequency1 GENERATE flatten($0), flatten(org.apache.pig.tutorial.ScoreGenerator($1));
</pre>
<ul>

<li>
<p> Use the FOREACH-GENERATE operator to assign names to the fields.  </p>

</li>

</ul>
<pre class="code">
uniq_frequency3 = FOREACH uniq_frequency2 GENERATE $1 as hour, $0 as ngram, $2 as score, $3 as count, $4 as mean;
</pre>
<ul>

<li>
<p> Use the FILTER operator to move all records with a score less than or equal to 2.0. </p>

</li>

</ul>
<pre class="code">
filtered_uniq_frequency = FILTER uniq_frequency3 BY score &gt; 2.0;
</pre>
<ul>

<li>
<p> Use the ORDER operator to sort the remaining records by hour and score. </p>

</li>

</ul>
<pre class="code">
ordered_uniq_frequency = ORDER filtered_uniq_frequency BY hour, score;
</pre>
<ul>

<li>
<p> Use the PigStorage function to store the results. The output file contains a list of n-grams with the following fields: <strong>hour</strong>, <strong>ngram</strong>, <strong>score</strong>, <strong>count</strong>, <strong>mean</strong>. </p>

</li>

</ul>
<pre class="code">
STORE ordered_uniq_frequency INTO '/tmp/tutorial-results' USING PigStorage(); 
</pre>
</div>


<a name="N102D9"></a><a name="Pig+Script+2%3A+Temporal+Query+Phrase+Popularity"></a>
<h2 class="h3">Pig Script 2: Temporal Query Phrase Popularity</h2>
<div class="section">
<p>The Temporal Query Phrase Popularity script (script2-local.pig or script2-hadoop.pig) processes a search query log file from the Excite search engine and compares the occurrence of frequency of search phrases across two time periods separated by twelve hours. </p>
<p>The script is shown here: </p>
<ul>

<li>
<p> Register the tutorial JAR file so that the user-defined functions (UDFs) can be called in the script. </p>

</li>

</ul>
<pre class="code">
REGISTER ./tutorial.jar;
</pre>
<ul>

<li>
<p> Use the PigStorage function to load the excite log file (excite.log or excite-small.log) into the &ldquo;raw&rdquo; bag as an array of records with the fields <strong>user</strong>, <strong>time</strong>, and <strong>query</strong>. </p>

</li>

</ul>
<pre class="code">
raw = LOAD 'excite.log' USING PigStorage('\t') AS (user, time, query);
</pre>
<ul>

<li>
<p> Call the NonURLDetector UDF to remove records if the query field is empty or a URL. </p>

</li>

</ul>
<pre class="code">
clean1 = FILTER raw BY org.apache.pig.tutorial.NonURLDetector(query);
</pre>
<ul>

<li>
<p> Call the ToLower UDF to change the query field to lowercase. </p>

</li>

</ul>
<pre class="code">
clean2 = FOREACH clean1 GENERATE user, time, org.apache.pig.tutorial.ToLower(query) as query;
</pre>
<ul>

<li>
<p> Because the log file only contains queries for a single day, we are only interested in the hour. The excite query log timestamp format is YYMMDDHHMMSS. Call the ExtractHour UDF to extract the hour from the time field. </p>

</li>

</ul>
<pre class="code">
houred = FOREACH clean2 GENERATE user, org.apache.pig.tutorial.ExtractHour(time) as hour, query;
</pre>
<ul>

<li>
<p> Call the NGramGenerator UDF to compose the n-grams of the query. </p>

</li>

</ul>
<pre class="code">
ngramed1 = FOREACH houred GENERATE user, hour, flatten(org.apache.pig.tutorial.NGramGenerator(query)) as ngram;
</pre>
<ul>

<li>
<p> Use the DISTINCT operator to get the unique n-grams for all records.  </p>

</li>

</ul>
<pre class="code">
ngramed2 = DISTINCT ngramed1;
</pre>
<ul>

<li>
<p> Use the GROUP operator to group the records by n-gram and hour.  </p>

</li>

</ul>
<pre class="code">
hour_frequency1 = GROUP ngramed2 BY (ngram, hour);
</pre>
<ul>

<li>
<p> Use the COUNT function to get the count (occurrences) of each n-gram.  </p>

</li>

</ul>
<pre class="code">
hour_frequency2 = FOREACH hour_frequency1 GENERATE flatten($0), COUNT($1) as count;
</pre>
<ul>

<li>
<p> Use the FOREACH-GENERATE operator to assign names to the fields. </p>

</li>

</ul>
<pre class="code">
hour_frequency3 = FOREACH hour_frequency2 GENERATE $0 as ngram, $1 as hour, $2 as count;
</pre>
<ul>

<li>
<p> Use the  FILTERoperator to get the n-grams for hour &lsquo;00&rsquo;  </p>

</li>

</ul>
<pre class="code">
hour00 = FILTER hour_frequency2 BY hour eq '00';
</pre>
<ul>

<li>
<p> Uses the FILTER operators to get the n-grams for hour &lsquo;12&rsquo; </p>

</li>

</ul>
<pre class="code">
hour12 = FILTER hour_frequency3 BY hour eq '12';
</pre>
<ul>

<li>
<p> Use the JOIN operator to get the n-grams that appear in both hours. </p>

</li>

</ul>
<pre class="code">
same = JOIN hour00 BY $0, hour12 BY $0;
</pre>
<ul>

<li>
<p> Use the FOREACH-GENERATE operator to record their frequency. </p>

</li>

</ul>
<pre class="code">
same1 = FOREACH same GENERATE hour_frequency2::hour00::group::ngram as ngram, $2 as count00, $5 as count12;
</pre>
<ul>

<li>
<p> Use the PigStorage function to store the results. The output file contains a list of n-grams with the following fields: <strong>hour</strong>, <strong>count00</strong>, <strong>count12</strong>. </p>

</li>

</ul>
<pre class="code">
STORE same1 INTO '/tmp/tutorial-join-results' USING PigStorage();
</pre>
</div>

</div>
<!--+
    |end content
    +-->
<div class="clearboth">&nbsp;</div>
</div>
<div id="footer">
<!--+
    |start bottomstrip
    +-->
<div class="lastmodified">
<script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
</div>
<div class="copyright">
        Copyright &copy;
         2007-2011 <a href="http://www.apache.org/licenses/">The Apache Software Foundation.</a>
</div>
<!--+
    |end bottomstrip
    +-->
</div>
</body>
</html>

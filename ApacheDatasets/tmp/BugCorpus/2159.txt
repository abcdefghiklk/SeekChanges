pig 2159 logic plan incorrect class sum classcastexcept asf jira script load 'input1' pigstorag ' ' f1 int f2 int f3 int f4 long f5 doubl load 'input2' pigstorag ' ' f1 int f2 int f3 int f4 long f5 doubl load 'input main' pigstorag ' ' f1 int f2 int f3 int union onschema join f1 f2 f3 left outer f1 f2 f3 porj foreach gener f1 f1 f2 f2 f3 f3 f4 f4 f5 f5 group porj f1 f2 f3 f5 final foreach gener sum porj f4 total dump final script fail comput sum class cast java lang classcastexcept java lang long cast java lang doubl org apach pig builtin doublesum initi exec doublesum java 82 19 bug logic plan creat 0 9 sum oper process org apach pig builtin longsum 0 9 logic plan org apach pig builtin doublesum meant sum doubl classcastexcept script work fine pig 0 8